"use strict";function compareValues(e,t){var r={"á":"a","é":"e","í":"i","ó":"o","ú":"u","à":"a","è":"e","ì":"i","ò":"o","ú":"u","ä":"a","ë":"e","ï":"i","ö":"o","ü":"u"};return e=String(e).toLowerCase().trim().replace(/\s\s+/g," ").replace(/[áéíóúàèìòùäëïöü]/g,function(e){return r[e]}),t=String(t).toLowerCase().trim().replace(/\s\s+/g," ").replace(/[áéíóúàèìòùäëïöü]/g,function(e){return r[e]}),!!e.includes(t)}function showMessage(e,t){$("#fixedLog p").text(e).css({color:"#FFF",background:t}),$("#fixedLog").fadeIn("slow",function(){setTimeout(function(){$("#fixedLog").fadeOut("slow")},2e3)})}var printersPersistent=new Object,basicFilters={hostname:!1,ip:!1,modelname:!1,firmware:!1,status:!1,alias:!1,location:!1,workteam:!1,reservedBy:!1},serverAddress="localhost",serverPort=8080,psOptions={minScrollbarLength:20},psHeaderBarSearchBasicFilters=new PerfectScrollbar("#headerBarSearchBasicFilters",psOptions),psIconsView=new PerfectScrollbar("#iconsView",psOptions),psListView=new PerfectScrollbar("#listView",psOptions),psColumnsViewFiltersWrapper=new PerfectScrollbar("#columnsViewFiltersWrapper",psOptions),psColumnsViewPopulation=new PerfectScrollbar("#columnsViewPopulation",psOptions),psColumnsViewPrinterWrapper=new PerfectScrollbar("#columnsViewPrinterWrapper",psOptions),psInfoMenu=new PerfectScrollbar("#infoMenu",psOptions),psEditMenu=new PerfectScrollbar("#editMenu",psOptions),psAdvancedFiltersMenu=new PerfectScrollbar("#advancedFiltersMenu",psOptions),psConfigMenu=new PerfectScrollbar("#configMenu",psOptions),dateTimePickerOptions={controlType:"select",oneLine:!0,timeInput:!0,dateFormat:"dd/mm/yy",timeFormat:"HH:mm:ss"};$(function(){$("#iconsViewTrigger").on("click touchstart",function(e){e.preventDefault(),$("#iconsView").is(":hidden")&&($("#listView, #columnsView").hide(),$("#iconsView").show(),$("#iconsView").scrollTop(0),psIconsView.update(),$("#listViewTrigger, #columnsViewTrigger").removeClass("current"),$("#iconsViewTrigger").addClass("current"))}),$("#listViewTrigger").on("click touchstart",function(e){e.preventDefault(),$("#listView").is(":hidden")&&($("#iconsView, #columnsView").hide(),$("#listView").show(),$("#listView").scrollTop(0),psListView.update(),$("#iconsViewTrigger, #columnsViewTrigger").removeClass("current"),$("#listViewTrigger").addClass("current"))}),$("#columnsViewTrigger").on("click touchstart",function(e){e.preventDefault(),$("#columnsView").is(":hidden")&&($("#iconsView, #listView").hide(),$("#columnsView").show(),$("#columnsViewFiltersWrapper").scrollTop(0),$("#columnsViewPopulation").scrollTop(0),$("#columnsViewPrinterWrapper").scrollTop(0),psColumnsViewFiltersWrapper.update(),psColumnsViewPopulation.update(),psColumnsViewPrinterWrapper.update(),$("#iconsViewTrigger, #listViewTrigger").removeClass("current"),$("#columnsViewTrigger").addClass("current"))}),$("#menusLeftover, #menusWrapper").on("click touchstart",function(e){!$("#infoMenu").is(":visible")||$(e.target).is("#infoMenu, #infoMenu *")&&!$(e.target).is(".closeButton")||(e.preventDefault(),$("#menus, #infoMenu").fadeOut("slow")),!$("#editMenu").is(":visible")||$(e.target).is("#editMenu, #editMenu *, #infoMenu button.actionButton")&&!$(e.target).is(".closeButton")||(e.preventDefault(),$("#menus, #editMenu").fadeOut("slow")),!$("#advancedFiltersMenu").is(":visible")||$(e.target).is("#advancedFiltersMenu, #advancedFiltersMenu *")&&!$(e.target).is(".closeButton")||(e.preventDefault(),$("#menus, #advancedFiltersMenu").fadeOut("slow")),!$("#configMenu").is(":visible")||$(e.target).is("#configMenu, #configMenu *")&&!$(e.target).is(".closeButton")||(e.preventDefault(),$("#menus, #configMenu").fadeOut("slow"))}),$(window).on("resize",function(e){psHeaderBarSearchBasicFilters.update(),psIconsView.update(),psListView.update(),psColumnsViewFiltersWrapper.update(),psColumnsViewPopulation.update(),psColumnsViewPrinterWrapper.update(),psInfoMenu.update(),psEditMenu.update(),psAdvancedFiltersMenu.update(),psConfigMenu.update()})}),$(function(){function e(){$.ajax({async:!0,crossDomain:!0,url:"http://"+serverAddress+":"+serverPort+"/printers/list",method:"GET",success:function(e,s){t(n(e,"basicInfo","modelname",!0)),r()},error:function(e,t,r){r?showMessage(e.status+" "+e.statusText,"red"):showMessage("Unable to connect to server","red")}})}function t(e){var t,r,s='<div id="iconsViewPopulation" class="wrapper"><p class="noPrinters">No printers to show with selected filters</p>',i='<tbody id="listViewPopulation">',a='<div id="columnsViewPopulation" class="wrapper"><p class="noPrinters">No printers to show with selected filters</p>';printersPersistent=new Object;for(var n=0;n<e.length;n++){if(t=o(),s+='<div name="'+t+'" class="printer',i+='<tr name="'+t+'" class="printer',a+='<div name="'+t+'" class="printer',e[n].detailedInfo.status)switch(e[n].detailedInfo.status.toLowerCase().trim().replace(/\s\s+/g," ")){case"awake":s+=" connected",i+=" connected",a+=" connected",r="Awake";break;case"sleep":s+=" missing",i+=" missing",a+=" missing",r="Sleep";break;case"unreachable":s+=" missing",i+=" missing",a+=" missing",r="Unreachable";break;case"turn off":s+=" missing",i+=" missing",a+=" missing",r="Turn Off";break;case"with alerts":s+=" warning",i+=" warning",a+=" warning",r="With Alerts";break;case"busy with activities":s+=" connected",i+=" connected",a+=" connected",r="Busy With Activities";break;case"with system errors":s+=" error",i+=" error",a+=" error",r="With System Errors";break;case"not initialized":s+=" missing",i+=" missing",a+=" missing",r="Not Initialized";break;default:s+=" missing",i+=" missing",a+=" missing",r="Unknown"}else s+=" missing",i+=" missing",a+=" missing",r="Unknown";s+='" title="'+r+'">',i+='">',a+='" title="'+r+'">',s+='<div class="info">',a+='<div class="info">',e[n].basicInfo.ip?(s+="<p>"+e[n].basicInfo.ip.trim().replace(/\s\s+/g," ")+"</p>",i+='<td title="'+e[n].basicInfo.ip.trim().replace(/\s\s+/g," ")+'">'+e[n].basicInfo.ip.trim().replace(/\s\s+/g," ")+"</td>",a+="<p>"+e[n].basicInfo.ip.trim().replace(/\s\s+/g," ")+"</p>"):(s+="<p>&mdash;</p>",i+="<td>&mdash;</td>"),e[n].basicInfo.modelname?(s+="<p>"+e[n].basicInfo.modelname.trim().replace(/\s\s+/g," ")+"</p>",i+='<td title="'+e[n].basicInfo.modelname.trim().replace(/\s\s+/g," ")+'">'+e[n].basicInfo.modelname.trim().replace(/\s\s+/g," ")+"</td>",a+="<p>"+e[n].basicInfo.modelname.trim().replace(/\s\s+/g," ")+"</p>"):(s+="<p>&mdash;</p>",i+="<td>&mdash;</td>"),e[n].detailedInfo.firmwareVersion?(s+="<p>"+e[n].detailedInfo.firmwareVersion.trim().replace(/\s\s+/g," ")+"</p>",i+='<td title="'+e[n].detailedInfo.firmwareVersion.trim().replace(/\s\s+/g," ")+'">'+e[n].detailedInfo.firmwareVersion.trim().replace(/\s\s+/g," ")+"</td>"):(s+="<p>&mdash;</p>",i+="<td>&mdash;</td>"),s+="</div>",a+="</div>",s+='<div class="status">',i+='<td class="status" title="'+r+'">'+r+"</td>",a+='<div class="status">',e[n].metadata.reservedBy&&e[n].metadata.reservedUntil&&(s+="<p>RESERVED</p>",a+="<p>R</p>"),i+=e[n].metadata.alias?'<td title="'+e[n].metadata.alias.trim().replace(/\s\s+/g," ")+'">'+e[n].metadata.alias.trim().replace(/\s\s+/g," ")+"</td>":"<td>&mdash;</td>",i+=e[n].metadata.reservedBy?'<td title="'+e[n].metadata.reservedBy.trim().replace(/\s\s+/g," ")+'">'+e[n].metadata.reservedBy.trim().replace(/\s\s+/g," ")+"</td>":"<td>&mdash;</td>",s+="</div></div>",i+="</tr>",a+="</div></div>",printersPersistent[t]=e[n]}s+="</div>",i+="</tbody>",a+="</div>",$("#iconsViewPopulation").remove(),$("#listViewPopulation").remove(),$("#columnsViewPopulation").remove(),$(s).appendTo("#iconsView"),$(i).appendTo("#listView table.wrapper"),$(a).appendTo("#columnsViewPrintersColumn"),psIconsView.update(),psListView.update(),psColumnsViewPopulation.destroy(),psColumnsViewPopulation=new PerfectScrollbar("#columnsViewPopulation",psOptions)}function r(){$("#iconsViewPopulation div.printer, #listViewPopulation tr.printer, #columnsViewPopulation div.printer").off(),$("#iconsViewPopulation div.printer, #listViewPopulation tr.printer").on("click touchstart",function(e){e.preventDefault();var t=s('<div id="infoMenuDetails" class="wrapper right">',printersPersistent[$(e.currentTarget).attr("name")]),r=i('<div id="infoMenuInformation" class="wrapper right">',printersPersistent[$(e.currentTarget).attr("name")].metadata);$("#infoMenuDetails").remove(),$("#infoMenuInformation").remove(),$(t).appendTo("#infoMenuDetailsWrapper"),$(r).appendTo("#infoMenuInformationWrapper"),$("#infoMenu button.actionButton").attr("name",$(e.currentTarget).attr("name")),$("#infoMenu").is(":hidden")&&($("#menus, #infoMenu").fadeIn("slow"),$("#infoMenu").scrollTop(0),psInfoMenu.update())}),$("#columnsViewPopulation div.printer").on("click touchstart",function(e){e.preventDefault();var t=s('<div id="columnsViewPrinterDetails" class="wrapper right">',printersPersistent[$(e.currentTarget).attr("name")]),r=i('<div id="columnsViewPrinterInformation" class="wrapper right">',printersPersistent[$(e.currentTarget).attr("name")].metadata);$("#columnsViewPrinterDetails").remove(),$("#columnsViewPrinterInformation").remove(),$(t).appendTo("#columnsViewPrinterDetailsWrapper"),$(r).appendTo("#columnsViewPrinterInformationWrapper"),$("#columnsViewPrinterWrapper button.actionButton").attr("name",$(e.currentTarget).attr("name")),$("#columnsViewPopulation div.current").removeClass("current"),$(e.currentTarget).addClass("current"),$("#columnsViewPrinterWrapper").fadeIn("slow"),$("#columnsViewPrinterWrapper").scrollTop(0),psColumnsViewPrinterWrapper.update()}),$("#iconsViewPopulation div.printer, #listViewPopulation tr.printer, #columnsViewPopulation div.printer").on("contextmenu",function(t){t.preventDefault();var r=$(t.currentTarget).attr("name");$("#contextMenuPrinters").css({top:t.pageY+"px",left:t.pageX+"px"}).show(),$(document).off().on("mousedown",function(t){if(t.preventDefault(),$(t.target).is('#contextMenuPrinters button[name="removeRes"]')){var s=printersPersistent[r],i=s.metadata;i.reservedBy=null,i.reservedUntil=null,$.ajax({async:!0,crossDomain:!0,url:"http://"+serverAddress+":"+serverPort+"/printers/update?ip="+s.basicInfo.ip+"&hostname="+s.basicInfo.hostname,method:"PUT",headers:{"Content-Type":"application/json"},processData:!1,data:JSON.stringify(i),success:function(t,r){showMessage("Reserve successfully removed","green"),e(),$("#columnsViewPrinterWrapper").hide()},error:function(e,t,r){r?showMessage(e.status+" "+e.statusText,"red"):showMessage("Unable to connect to server","red")}})}else if($(t.target).is('#contextMenuPrinters button[name="forceUpdate"]')){var s=printersPersistent[r];$.ajax({async:!0,crossDomain:!0,url:"http://"+serverAddress+":"+serverPort+"/printers/update?ip="+s.basicInfo.ip+"&hostname="+s.basicInfo.hostname,method:"GET",success:function(t,r){showMessage("Printer successfully updated (force mode)","green"),e(),$("#columnsViewPrinterWrapper").hide()},error:function(e,t,r){r?showMessage(e.status+" "+e.statusText,"red"):showMessage("Unable to connect to server","red")}})}$("#contextMenuPrinters").hide(),$(document).off()})})}function s(e,t){if(e+=t.basicInfo.hostname?'<p title="'+t.basicInfo.hostname.trim().replace(/\s\s+/g," ")+'">'+t.basicInfo.hostname.trim().replace(/\s\s+/g," ")+"</p>":"<p>&mdash;</p>",e+=t.basicInfo.ip?'<p title="'+t.basicInfo.ip.trim().replace(/\s\s+/g," ")+'">'+t.basicInfo.ip.trim().replace(/\s\s+/g," ")+"</p>":"<p>&mdash;</p>",e+=t.basicInfo.modelname?'<p title="'+t.basicInfo.modelname.trim().replace(/\s\s+/g," ")+'">'+t.basicInfo.modelname.trim().replace(/\s\s+/g," ")+"</p>":"<p>&mdash;</p>",e+=t.detailedInfo.firmwareVersion?'<p title="'+t.detailedInfo.firmwareVersion.trim().replace(/\s\s+/g," ")+'">'+t.detailedInfo.firmwareVersion.trim().replace(/\s\s+/g," ")+"</p>":"<p>&mdash;</p>",t.detailedInfo.status){switch(e+='<p class="status',t.detailedInfo.status.toLowerCase().trim().replace(/\s\s+/g," ")){case"awake":e+=" connected";break;case"sleep":e+=" missing";break;case"unreachable":e+=" missing";break;case"turn off":e+=" missing";break;case"with alerts":e+=" warning";break;case"busy with activities":e+=" connected";break;case"with system errors":e+=" error";break;case"not initialized":e+=" missing";break;default:e+=" missing"}e+='" title="'+t.detailedInfo.status.trim().replace(/\s\s+/g," ")+'">'+t.detailedInfo.status.trim().replace(/\s\s+/g," ")+"</p>"}else e+='<p class="status missing">Unknown</p>';if(t.creationDate){var r=new Date(t.creationDate);e+='<p title="'+r+'">'+("0"+r.getDate()).slice(-2)+"/"+("0"+(r.getMonth()+1)).slice(-2)+"/"+r.getFullYear()+" "+("0"+r.getHours()).slice(-2)+":"+("0"+r.getMinutes()).slice(-2)+":"+("0"+r.getSeconds()).slice(-2)+"</p>"}else e+="<p>&mdash;</p>";if(t.lastUpdate.status){var r=new Date(t.lastUpdate.status);e+='<p title="'+r+'">'+("0"+r.getDate()).slice(-2)+"/"+("0"+(r.getMonth()+1)).slice(-2)+"/"+r.getFullYear()+" "+("0"+r.getHours()).slice(-2)+":"+("0"+r.getMinutes()).slice(-2)+":"+("0"+r.getSeconds()).slice(-2)+"</p>"}else e+="<p>&mdash;</p>";return e+="</div>"}function i(e,t){if(e+=t.alias?'<p title="'+t.alias.trim().replace(/\s\s+/g," ")+'">'+t.alias.trim().replace(/\s\s+/g," ")+"</p>":"<p>&mdash;</p>",e+=t.location?'<p title="'+t.location.trim().replace(/\s\s+/g," ")+'">'+t.location.trim().replace(/\s\s+/g," ")+"</p>":"<p>&mdash;</p>",e+=t.workteam?'<p title="'+t.workteam.trim().replace(/\s\s+/g," ")+'">'+t.workteam.trim().replace(/\s\s+/g," ")+"</p>":"<p>&mdash;</p>",e+=t.reservedBy?'<p title="'+t.reservedBy.trim().replace(/\s\s+/g," ")+'">'+t.reservedBy.trim().replace(/\s\s+/g," ")+"</p>":"<p>&mdash;</p>",t.reservedUntil){var r=new Date(t.reservedUntil);e+='<p title="'+r+'">'+("0"+r.getDate()).slice(-2)+"/"+("0"+(r.getMonth()+1)).slice(-2)+"/"+r.getFullYear()+" "+("0"+r.getHours()).slice(-2)+":"+("0"+r.getMinutes()).slice(-2)+":"+("0"+r.getSeconds()).slice(-2)+"</p>"}else e+="<p>&mdash;</p>";return e+="</div>"}function a(e){if(e.alias?$('#editForm input[name="alias"]').val(e.alias.trim().replace(/\s\s+/g," ")):$('#editForm input[name="alias"]').val(""),e.location?$('#editForm input[name="location"]').val(e.location.trim().replace(/\s\s+/g," ")):$('#editForm input[name="location"]').val(""),e.workteam?$('#editForm input[name="workteam"]').val(e.workteam.trim().replace(/\s\s+/g," ")):$('#editForm input[name="workteam"]').val(""),e.reservedBy?$('#editForm input[name="reservedBy"]').val(e.reservedBy.trim().replace(/\s\s+/g," ")):$('#editForm input[name="reservedBy"]').val(""),e.reservedUntil){var t=new Date(e.reservedUntil);$('#editForm input[name="reservedUntil"]').val(("0"+t.getDate()).slice(-2)+"/"+("0"+(t.getMonth()+1)).slice(-2)+"/"+t.getFullYear()+" "+("0"+t.getHours()).slice(-2)+":"+("0"+t.getMinutes()).slice(-2)+":"+("0"+t.getSeconds()).slice(-2))}else $('#editForm input[name="reservedUntil"]').val("")}function n(e,t,r,s){return e.sort(function(e,i){return s?r?e[t][r]>i[t][r]?1:e[t][r]<i[t][r]?-1:0:e[t]>i[t]?1:e[t]<i[t]?-1:0:r?i[t][r]>e[t][r]?1:i[t][r]<e[t][r]?-1:0:i[t]>e[t]?1:i[t]<e[t]?-1:0})}function o(){var e,t,r="";for(e=0;e<32;e++)t=16*Math.random()|0,8!=e&&12!=e&&16!=e&&20!=e||(r+="-"),r+=(12==e?4:16==e?3&t|8:t).toString(16);return r}e(),$("#infoMenu button.actionButton, #columnsViewPrinterWrapper button.actionButton").on("click touchstart",function(e){e.preventDefault();var t=s('<div id="editMenuDetails" class="wrapper right">',printersPersistent[e.currentTarget.name]);$("#editMenuDetails").remove(),$(t).appendTo("#editMenuDetailsWrapper"),a(printersPersistent[e.currentTarget.name].metadata),$("#editForm input.datetimepicker").datetimepicker(dateTimePickerOptions),$("#editMenu button.actionButton").attr("name",e.currentTarget.name),$("#editMenu").is(":hidden")&&($("#menus").is(":hidden")&&$("#menus").fadeIn("slow"),$("#infoMenu").is(":visible")&&$("#infoMenu").hide(),$("#editMenu").fadeIn("slow"),$("#editMenu").scrollTop(0),psEditMenu.update())}),$("#editForm").on("submit",function(t){t.preventDefault();var r=$('#editForm input[name="reservedUntil"]').val().trim().replace(/\s\s+/g," ").split(/\/|\s|\:/),s=printersPersistent[$("#editMenu button.actionButton").attr("name")],i={alias:$('#editForm input[name="alias"]').val().trim().replace(/\s\s+/g," "),location:$('#editForm input[name="location"]').val().trim().replace(/\s\s+/g," "),workteam:$('#editForm input[name="workteam"]').val().trim().replace(/\s\s+/g," "),reservedBy:$('#editForm input[name="reservedBy"]').val().trim().replace(/\s\s+/g," "),reservedUntil:new Date(r[2],r[1]-1,r[0],r[3],r[4],r[5]).getTime(),calendar:[]};for(var a in i)""==i[a]&&(i[a]=null);$.ajax({async:!0,crossDomain:!0,url:"http://"+serverAddress+":"+serverPort+"/printers/update?ip="+s.basicInfo.ip+"&hostname="+s.basicInfo.hostname,method:"PUT",headers:{"Content-Type":"application/json"},processData:!1,data:JSON.stringify(i),success:function(t,r){showMessage("Information successfully updated","green"),e(),$("#columnsViewPrinterWrapper").hide(),$("#menus, #editMenu").fadeOut("slow")},error:function(e,t,r){r?showMessage(e.status+" "+e.statusText,"red"):showMessage("Unable to connect to server","red")}})})}),$(function(){$("#configMenuTrigger").on("click touchstart",function(e){e.preventDefault(),$("#configMenu").is(":hidden")&&$.ajax({async:!0,crossDomain:!0,url:"http://"+serverAddress+":"+serverPort+"/config/data",method:"GET",success:function(e,t){e.logLevel?$('#configForm input[name="logLevel"]').val(e.logLevel):$('#configForm input[name="logLevel"]').val(""),e.logSeparator?$('#configForm input[name="logSeparator"]').val(e.logSeparator):$('#configForm input[name="logSeparator"]').val(""),e.updateFrequency?$('#configForm input[name="updateFrequency"]').val(e.updateFrequency/1e3):$('#configForm input[name="updateFrequency"]').val(""),e.deleteTimeout?$('#configForm input[name="deleteTimeout"]').val(e.deleteTimeout/6e4):$('#configForm input[name="deleteTimeout"]').val(""),$("#menus, #configMenu").fadeIn("slow"),$("#configMenu").scrollTop(0),psConfigMenu.update()},error:function(e,t,r){r?showMessage(e.status+" "+e.statusText,"red"):showMessage("Unable to connect to server","red")}})}),$("#configForm").on("submit",function(e){e.preventDefault(),$.ajax({async:!0,crossDomain:!0,url:"http://"+serverAddress+":"+serverPort+"/config/update",method:"PUT",headers:{"Content-Type":"application/json"},processData:!1,data:JSON.stringify({logLevel:parseInt($('#configForm input[name="logLevel"]').val()),logSeparator:parseInt($('#configForm input[name="logSeparator"]').val()),updateFrequency:1e3*parseInt($('#configForm input[name="updateFrequency"]').val()),deleteTimeout:6e4*parseInt($('#configForm input[name="deleteTimeout"]').val())}),success:function(e,t){showMessage("Configuration successfully updated","green"),$("#menus, #configMenu").fadeOut("slow")},error:function(e,t,r){r?showMessage(e.status+" "+e.statusText,"red"):showMessage("Unable to connect to server","red")}})})}),$(function(){function e(e){var t,r=!0,s=!0;for(var i in basicFilters)if(basicFilters[i]){r=!1;break}for(var a in printersPersistent)t=!1,!t&&printersPersistent[a].basicInfo&&(!t&&(r||basicFilters.hostname)&&compareValues(printersPersistent[a].basicInfo.hostname,e)&&(t=!0),!t&&(r||basicFilters.ip)&&compareValues(printersPersistent[a].basicInfo.ip,e)&&(t=!0),!t&&(r||basicFilters.modelname)&&compareValues(printersPersistent[a].basicInfo.modelname,e)&&(t=!0)),!t&&printersPersistent[a].detailedInfo&&(!t&&(r||basicFilters.firmware)&&compareValues(printersPersistent[a].detailedInfo.firmwareVersion,e)&&(t=!0),!t&&(r||basicFilters.status)&&compareValues(printersPersistent[a].detailedInfo.status,e)&&(t=!0)),!t&&printersPersistent[a].metadata&&(!t&&(r||basicFilters.alias)&&compareValues(printersPersistent[a].metadata.alias,e)&&(t=!0),!t&&(r||basicFilters.location)&&compareValues(printersPersistent[a].metadata.location,e)&&(t=!0),!t&&(r||basicFilters.workteam)&&compareValues(printersPersistent[a].metadata.workteam,e)&&(t=!0),!t&&(r||basicFilters.reservedBy)&&compareValues(printersPersistent[a].metadata.reservedBy,e)&&(t=!0)),t?(s=!1,$('#iconsViewPopulation div.printer[name="'+a+'"]').show(),$('#listViewPopulation tr.printer[name="'+a+'"]').show(),$('#columnsViewPopulation div.printer[name="'+a+'"]').show()):($('#iconsViewPopulation div.printer[name="'+a+'"]').hide(),$('#listViewPopulation tr.printer[name="'+a+'"]').hide(),$('#columnsViewPopulation div.printer[name="'+a+'"]').hide());s?$("p.noPrinters").show():$("p.noPrinters").hide(),$("#iconsView").scrollTop(0),psIconsView.update(),$("#listView").scrollTop(0),psListView.update(),$("#columnsViewPopulation").scrollTop(0),psColumnsViewPopulation.update()}$("#headerBarSearchInput").on("keyup",function(t){t.preventDefault(),e($("#headerBarSearchInput").val())}),$("#headerBarSearchBasicFilters button.basic").on("click touchstart",function(t){t.preventDefault(),$("#headerBarSearchBasicFilters button.advanced").removeClass("current"),$(this).hasClass("current")?$(this).removeClass("current"):$(this).addClass("current"),basicFilters[$(this).attr("name")]=!basicFilters[$(this).attr("name")],e($("#headerBarSearchInput").val())})}),$(function(){function e(){for(var e=document.cookie.split(/\;|\=/),r=0;r<e.length-1;r+=2)$('<button class="advanced" name="'+e[r].trim()+'" title="'+s(JSON.parse(e[r+1].trim()))+'">'+e[r].trim()+"</button>").insertAfter("#headerBarSearchBasicFilters span.separator"),i[e[r].trim()]=JSON.parse(e[r+1].trim());$("#headerBarSearchBasicFilters").show().scrollTop(0),psHeaderBarSearchBasicFilters.update(),$("#headerBarSearchBasicFilters").hide(),t()}function t(){$("#headerBarSearchBasicFilters button.advanced").off(),$("#headerBarSearchBasicFilters button.advanced").on("click touchstart",function(e){if(e.preventDefault(),$(this).hasClass("current"))$(this).removeClass("current"),r({});else{$("#headerBarSearchInput").val("");for(var t in basicFilters)basicFilters[t]=!1;$("#headerBarSearchBasicFilters button").removeClass("current"),$(this).addClass("current"),r(i[$(this).attr("name")])}}),$("#headerBarSearchBasicFilters button.advanced").on("contextmenu",function(e){e.preventDefault();var t=confirm('Are you sure you want to delete the filter "'+$(this).attr("name")+'"?\n'+$(this).attr("title"));t&&($(this).hasClass("current")&&r({}),$(this).remove(),document.cookie=$(this).attr("name")+"=;max-age=0",$("#headerBarSearchBasicFilters").show().scrollTop(0),psHeaderBarSearchBasicFilters.update(),$("#headerBarSearchBasicFilters").hide())})}function r(e){var t,r=!0;for(var s in printersPersistent)t=!0,t&&printersPersistent[s].basicInfo&&(t&&e.hostname&&!compareValues(printersPersistent[s].basicInfo.hostname,e.hostname)&&(t=!1),t&&e.ip&&!compareValues(printersPersistent[s].basicInfo.ip,e.ip)&&(t=!1),t&&e.modelname&&!compareValues(printersPersistent[s].basicInfo.modelname,e.modelname)&&(t=!1)),t&&printersPersistent[s].detailedInfo&&(t&&e.firmware&&!compareValues(printersPersistent[s].detailedInfo.firmwareVersion,e.firmware)&&(t=!1),t&&e.status&&!compareValues(printersPersistent[s].detailedInfo.status,e.status)&&(t=!1)),t&&e.creationDate&&!compareValues(printersPersistent[s].creationDate,e.creationDate)&&(t=!1),t&&printersPersistent[s].lastUpdate&&t&&e.lastUpdateStatus&&!compareValues(printersPersistent[s].lastUpdate.status,e.lastUpdateStatus)&&(t=!1),t&&printersPersistent[s].metadata&&(t&&e.alias&&!compareValues(printersPersistent[s].metadata.alias,e.alias)&&(t=!1),t&&e.location&&!compareValues(printersPersistent[s].metadata.location,e.location)&&(t=!1),t&&e.workteam&&!compareValues(printersPersistent[s].metadata.workteam,e.workteam)&&(t=!1),t&&e.reservedBy&&!compareValues(printersPersistent[s].metadata.reservedBy,e.reservedBy)&&(t=!1),t&&e.reservedUntil&&!compareValues(printersPersistent[s].metadata.reservedUntil,e.reservedUntil)&&(t=!1)),t?(r=!1,$('#iconsViewPopulation div.printer[name="'+s+'"]').show(),$('#listViewPopulation tr.printer[name="'+s+'"]').show(),$('#columnsViewPopulation div.printer[name="'+s+'"]').show()):($('#iconsViewPopulation div.printer[name="'+s+'"]').hide(),$('#listViewPopulation tr.printer[name="'+s+'"]').hide(),$('#columnsViewPopulation div.printer[name="'+s+'"]').hide());r?$("p.noPrinters").show():$("p.noPrinters").hide(),$("#iconsView").scrollTop(0),psIconsView.update(),$("#listView").scrollTop(0),psListView.update(),$("#columnsViewPopulation").scrollTop(0),psColumnsViewPopulation.update()}function s(e){var t="";for(var r in e)e[r]&&(t+="number"==typeof e[r]&&e[r]>31536e6?r+": "+new Date(e[r]).toLocaleString()+"\n":r+": "+e[r]+"\n");return t}var i=new Object;e(),$("#advancedFiltersMenuTrigger").on("click touchstart",function(e){e.preventDefault(),$("#filterFormDetails input").val(""),$("#filterFormInfo input").val(""),$("#filterFormName input").val(""),$("#filterFormDetails input.datetimepicker, #filterFormInfo input.datetimepicker").datetimepicker(dateTimePickerOptions),$("#advancedFiltersMenu").is(":hidden")&&($("#menus, #advancedFiltersMenu").fadeIn("slow"),$("#advancedFiltersMenu").scrollTop(0),psAdvancedFiltersMenu.update())}),$("#filterFormName").on("submit",function(e){e.preventDefault();var a=$('#filterFormName input[name="filterName"]').val().trim().replace(/\s\s+/g," ");if(a){var n=$('#filterFormDetails input[name="creationDate"]').val().trim().replace(/\s\s+/g," ").split(/\/|\s|\:/),o=$('#filterFormDetails input[name="lastUpdateStatus"]').val().trim().replace(/\s\s+/g," ").split(/\/|\s|\:/),l=$('#filterFormInfo input[name="reservedUntil"]').val().trim().replace(/\s\s+/g," ").split(/\/|\s|\:/),c={hostname:$('#filterFormDetails input[name="hostname"]').val().trim().replace(/\s\s+/g," "),ip:$('#filterFormDetails input[name="ip"]').val().trim().replace(/\s\s+/g," "),modelname:$('#filterFormDetails input[name="modelname"]').val().trim().replace(/\s\s+/g," "),firmware:$('#filterFormDetails input[name="firmware"]').val().trim().replace(/\s\s+/g," "),status:$('#filterFormDetails input[name="status"]').val().trim().replace(/\s\s+/g," "),creationDate:new Date(n[2],n[1]-1,n[0],n[3],n[4],n[5]).getTime(),lastUpdateStatus:new Date(o[2],o[1]-1,o[0],o[3],o[4],o[5]).getTime(),alias:$('#filterFormInfo input[name="alias"]').val().trim().replace(/\s\s+/g," "),location:$('#filterFormInfo input[name="location"]').val().trim().replace(/\s\s+/g," "),workteam:$('#filterFormInfo input[name="workteam"]').val().trim().replace(/\s\s+/g," "),reservedBy:$('#filterFormInfo input[name="reservedBy"]').val().trim().replace(/\s\s+/g," "),reservedUntil:new Date(l[2],l[1]-1,l[0],l[3],l[4],l[5]).getTime()};for(var p in c)""==c[p]&&(c[p]=null);$("#headerBarSearchInput").val("");for(var u in basicFilters)basicFilters[u]=!1;$("#headerBarSearchBasicFilters button").removeClass("current"),$('#headerBarSearchBasicFilters button[name="'+a+'"]').remove(),$('<button class="advanced current" name="'+a+'" title="'+s(c)+'">'+a+"</button>").insertAfter("#headerBarSearchBasicFilters span.separator"),$("#headerBarSearchBasicFilters").show().scrollTop(0),psHeaderBarSearchBasicFilters.update(),$("#headerBarSearchBasicFilters").hide(),i[a]=c,document.cookie=a+"="+JSON.stringify(c)+";max-age=315360000",t(),r(c),$("#menus, #advancedFiltersMenu").fadeOut("slow")}else $('#filterFormName input[name="filterName"]').focus(),showMessage("Filter name is mandatory","red")})});