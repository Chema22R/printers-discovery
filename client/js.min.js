"use strict";function showMessage(e,i){$("#fixedLog p").text(e).css({color:"#FFF",background:i}),$("#fixedLog").fadeIn("slow",function(){setTimeout(function(){$("#fixedLog").fadeOut("slow")},2e3)})}var serverAddress="localhost",serverPort=8080;$(function(){$("#iconsViewTrigger").on("click touchstart",function(e){e.preventDefault(),$("#iconsView").is(":hidden")&&($("#iconsView").fadeIn(0),$("#listView, #columnsView").fadeOut(0),$("#iconsViewTrigger").addClass("current"),$("#listViewTrigger, #columnsViewTrigger").removeClass("current"))}),$("#listViewTrigger").on("click touchstart",function(e){e.preventDefault(),$("#listView").is(":hidden")&&($("#listView").fadeIn(0),$("#iconsView, #columnsView").fadeOut(0),$("#listViewTrigger").addClass("current"),$("#iconsViewTrigger, #columnsViewTrigger").removeClass("current"))}),$("#columnsViewTrigger").on("click touchstart",function(e){e.preventDefault(),$("#columnsView").is(":hidden")&&($("#columnsView").fadeIn(0),$("#iconsView, #listView").fadeOut(0),$("#columnsViewTrigger").addClass("current"),$("#iconsViewTrigger, #listViewTrigger").removeClass("current"))}),$("#advancedFiltersMenuTrigger").on("click touchstart",function(e){e.preventDefault(),$("#advancedFiltersMenu").is(":hidden")&&$("#menus, #advancedFiltersMenu").fadeIn("slow")}),$("#configMenuTrigger").on("click touchstart",function(e){e.preventDefault(),$("#configMenu").is(":hidden")&&$("#menus, #configMenu").fadeIn("slow")}),$("#menusLeftover, #menusWrapper").on("click touchstart",function(e){e.preventDefault(),!$("#infoMenu").is(":visible")||$(e.target).is("#infoMenu, #infoMenu *")&&!$(e.target).is(".closeButton")||$("#menus, #infoMenu").fadeOut("slow"),!$("#editMenu").is(":visible")||$(e.target).is("#editMenu, #editMenu *")&&!$(e.target).is(".closeButton")||$("#menus, #editMenu").fadeOut("slow"),!$("#advancedFiltersMenu").is(":visible")||$(e.target).is("#advancedFiltersMenu, #advancedFiltersMenu *")&&!$(e.target).is(".closeButton")||$("#menus, #advancedFiltersMenu").fadeOut("slow"),!$("#configMenu").is(":visible")||$(e.target).is("#configMenu, #configMenu *")&&!$(e.target).is(".closeButton")||$("#menus, #configMenu").fadeOut("slow")})}),$(function(){function e(e){for(var i,s,n='<div id="iconsViewPopulation" class="wrapper">',r='<tbody id="listViewPopulation">',o='<div id="columnsViewPopulation" class="wrapper">',d=0;d<e.length;d++){if(i=t(),n+='<div id="'+i+'" class="printer',r+='<tr id="'+i+'" class="printer',o+='<div id="'+i+'" class="printer',e[d].detailedInfo.status)switch(e[d].detailedInfo.status.toLowerCase()){case"awake":n+=" connected",r+=" connected",o+=" connected",s="Awake";break;case"sleep":n+=" missing",r+=" missing",o+=" missing",s="Sleep";break;case"unreachable":n+=" missing",r+=" missing",o+=" missing",s="Unreachable";break;case"turn off":n+=" missing",r+=" missing",o+=" missing",s="Turn Off";break;case"with alerts":n+=" warning",r+=" warning",o+=" warning",s="With Alerts";break;case"busy with activities":n+=" connected",r+=" connected",o+=" connected",s="Busy With Activities";break;case"with system errors":n+=" error",r+=" error",o+=" error",s="With System Errors";break;case"not initialized":n+=" missing",r+=" missing",o+=" missing",s="Not Initialized";break;default:n+=" missing",r+=" missing",o+=" missing",s="Unknown"}else n+=" missing",r+=" missing",o+=" missing",s="Unknown";n+='" title="'+s+'">',r+='">',o+='" title="'+s+'">',n+='<div class="info">',o+='<div class="info">',e[d].basicInfo.ip?(n+="<p>"+e[d].basicInfo.ip.replace(/\s/g,"&nbsp;")+"</p>",r+="<td>"+e[d].basicInfo.ip+"</td>",o+="<p>"+e[d].basicInfo.ip.replace(/\s/g,"&nbsp;")+"</p>"):(n+="<p>&mdash;</p>",r+="<td>&mdash;</td>"),e[d].basicInfo.modelname?(n+="<p>"+e[d].basicInfo.modelname.replace(/\s/g,"&nbsp;")+"</p>",r+="<td>"+e[d].basicInfo.modelname+"</td>",o+="<p>"+e[d].basicInfo.modelname.replace(/\s/g,"&nbsp;")+"</p>"):(n+="<p>&mdash;</p>",r+="<td>&mdash;</td>"),e[d].detailedInfo.firmwareVersion?(n+="<p>"+e[d].detailedInfo.firmwareVersion.replace(/\s/g,"&nbsp;")+"</p>",r+="<td>"+e[d].detailedInfo.firmwareVersion+"</td>"):(n+="<p>&mdash;</p>",r+="<td>&mdash;</td>"),r+='<td class="state">'+s+"</td>",r+=e[d].metadata.alias?"<td>"+e[d].metadata.alias+"</td>":"<td>&mdash;</td>",r+=e[d].metadata.reservedBy?"<td>"+e[d].metadata.reservedBy+"</td>":"<td>&mdash;</td>",n+="</div>",o+="</div>",n+='<div class="state">',o+='<div class="state">',null!=e[d].metadata.reservedBy&&null!=e[d].metadata.reservedUntil&&(n+="<p>RESERVED</p>",o+="<p>R</p>"),n+="</div></div>",r+="</tr>",o+="</div></div>",a[i]=e[d]}n+="</div>",r+="</tbody>",o+="</div>",$("#iconsViewPopulation").remove(),$("#listViewPopulation").remove(),$("#columnsViewPopulation").remove(),$(n).appendTo("#iconsView"),$(r).appendTo("#listView table.wrapper"),$(o).appendTo("#columnsViewPrintersColumn")}function i(){$("#iconsViewPopulation div.printer, #listViewPopulation tr.printer").off().on("click touchstart",function(e){e.preventDefault();var i=s('<div id="infoMenuDetails" class="wrapper right">',a[e.currentTarget.id]),t=n('<div id="infoMenuInformation" class="wrapper right">',a[e.currentTarget.id]);$("#infoMenuDetails").remove(),$("#infoMenuInformation").remove(),$(i).appendTo("#infoMenuDetailsWrapper"),$(t).appendTo("#infoMenuInformationWrapper"),$("#infoMenu").is(":hidden")&&$("#menus, #infoMenu").fadeIn("slow")}),$("#columnsViewPopulation div.printer").off().on("click touchstart",function(e){e.preventDefault();var i=s('<div id="columnsViewPrinterDetails" class="wrapper right">',a[e.currentTarget.id]),t=n('<div id="columnsViewPrinterInformation" class="wrapper right">',a[e.currentTarget.id]);$("#columnsViewPrinterDetails").remove(),$("#columnsViewPrinterInformation").remove(),$(i).appendTo("#columnsViewPrinterDetailsWrapper"),$(t).appendTo("#columnsViewPrinterInformationWrapper"),$("#columnsViewPrinterDataColumn *").fadeIn("slow")})}function s(e,i){if(e+=i.basicInfo.hostname?"<p>"+i.basicInfo.hostname.replace(/\s/g,"&nbsp;")+"</p>":"<p>&mdash;</p>",e+=i.basicInfo.ip?"<p>"+i.basicInfo.ip.replace(/\s/g,"&nbsp;")+"</p>":"<p>&mdash;</p>",e+=i.basicInfo.modelname?"<p>"+i.basicInfo.modelname.replace(/\s/g,"&nbsp;")+"</p>":"<p>&mdash;</p>",e+=i.detailedInfo.firmwareVersion?"<p>"+i.detailedInfo.firmwareVersion.replace(/\s/g,"&nbsp;")+"</p>":"<p>&mdash;</p>",i.detailedInfo.status){switch(e+='<p class="state',i.detailedInfo.status.toLowerCase()){case"awake":e+=" connected";break;case"sleep":e+=" missing";break;case"unreachable":e+=" missing";break;case"turn off":e+=" missing";break;case"with alerts":e+=" warning";break;case"busy with activities":e+=" connected";break;case"with system errors":e+=" error";break;case"not initialized":e+=" missing";break;default:e+=" missing"}e+='">'+i.detailedInfo.status.replace(/\s/g,"&nbsp;")+"</p>"}else e+='<p class="state missing">Unknown</p>';return e+=i.creationDate?"<p>"+new Date(i.creationDate).toLocaleString().replace(/\s/g,"&nbsp;")+"</p>":"<p>&mdash;</p>",e+=i.lastUpdate.status?"<p>"+new Date(i.lastUpdate.status).toLocaleString().replace(/\s/g,"&nbsp;")+"</p>":"<p>&mdash;</p>",e+="</div>"}function n(e,i){return e+=i.metadata.alias?"<p>"+i.metadata.alias.replace(/\s/g,"&nbsp;")+"</p>":"<p>&mdash;</p>",e+=i.metadata.location?"<p>"+i.metadata.location.replace(/\s/g,"&nbsp;")+"</p>":"<p>&mdash;</p>",e+=i.metadata.workteam?"<p>"+i.metadata.workteam.replace(/\s/g,"&nbsp;")+"</p>":"<p>&mdash;</p>",e+=i.metadata.reservedBy?"<p>"+i.metadata.reservedBy.replace(/\s/g,"&nbsp;")+"</p>":"<p>&mdash;</p>",e+=i.metadata.reservedUntil?"<p>"+new Date(i.metadata.reservedUntil).toLocaleString().replace(/\s/g,"&nbsp;")+"</p>":"<p>&mdash;</p>",e+="</div>"}function t(){var e,i,s="";for(e=0;e<32;e++)i=16*Math.random()|0,8!=e&&12!=e&&16!=e&&20!=e||(s+="-"),s+=(12==e?4:16==e?3&i|8:i).toString(16);return s}var a={};$.ajax({url:"http://"+serverAddress+":"+serverPort+"/printers/list",method:"GET",success:function(s,n){e(s),i()},error:function(e,i,s){s?showMessage(e.responseText,"red"):showMessage("Unable to connect to server","red")}})});