"use strict";function showMessage(e,t){$("#fixedLog p").text(e).css({color:"#FFF",background:t}),$("#fixedLog").fadeIn("slow",function(){setTimeout(function(){$("#fixedLog").fadeOut("slow")},2e3)})}var serverAddress="localhost",serverPort=8080;$(function(){$("#iconsViewTrigger").on("click touchstart",function(e){e.preventDefault(),$("#iconsView").is(":hidden")&&($("#iconsView").fadeIn(0),$("#listView, #columnsView").fadeOut(0),$("#iconsViewTrigger").addClass("current"),$("#listViewTrigger, #columnsViewTrigger").removeClass("current"))}),$("#listViewTrigger").on("click touchstart",function(e){e.preventDefault(),$("#listView").is(":hidden")&&($("#listView").fadeIn(0),$("#iconsView, #columnsView").fadeOut(0),$("#listViewTrigger").addClass("current"),$("#iconsViewTrigger, #columnsViewTrigger").removeClass("current"))}),$("#columnsViewTrigger").on("click touchstart",function(e){e.preventDefault(),$("#columnsView").is(":hidden")&&($("#columnsView").fadeIn(0),$("#iconsView, #listView").fadeOut(0),$("#columnsViewTrigger").addClass("current"),$("#iconsViewTrigger, #listViewTrigger").removeClass("current"))}),$("#advancedFiltersMenuTrigger").on("click touchstart",function(e){e.preventDefault(),$("#advancedFiltersMenu").is(":hidden")&&$("#menus, #advancedFiltersMenu").fadeIn("slow")}),$("#configMenuTrigger").on("click touchstart",function(e){e.preventDefault(),$("#configMenu").is(":hidden")&&$("#menus, #configMenu").fadeIn("slow")}),$("#menusLeftover, #menusWrapper").on("click touchstart",function(e){!$("#infoMenu").is(":visible")||$(e.target).is("#infoMenu, #infoMenu *")&&!$(e.target).is(".closeButton")||(e.preventDefault(),$("#menus, #infoMenu").fadeOut("slow")),!$("#editMenu").is(":visible")||$(e.target).is("#editMenu, #editMenu *, #infoMenu button.actionButton")&&!$(e.target).is(".closeButton")||(e.preventDefault(),$("#menus, #editMenu").fadeOut("slow")),!$("#advancedFiltersMenu").is(":visible")||$(e.target).is("#advancedFiltersMenu, #advancedFiltersMenu *")&&!$(e.target).is(".closeButton")||(e.preventDefault(),$("#menus, #advancedFiltersMenu").fadeOut("slow")),!$("#configMenu").is(":visible")||$(e.target).is("#configMenu, #configMenu *")&&!$(e.target).is(".closeButton")||(e.preventDefault(),$("#menus, #configMenu").fadeOut("slow"))})}),$(function(){function e(e){for(var t,a,i='<div id="iconsViewPopulation" class="wrapper">',n='<tbody id="listViewPopulation">',o='<div id="columnsViewPopulation" class="wrapper">',d=0;d<e.length;d++){if(t=s(),i+='<div id="'+t+'" class="printer',n+='<tr id="'+t+'" class="printer',o+='<div id="'+t+'" class="printer',e[d].detailedInfo.status)switch(e[d].detailedInfo.status.toLowerCase()){case"awake":i+=" connected",n+=" connected",o+=" connected",a="Awake";break;case"sleep":i+=" missing",n+=" missing",o+=" missing",a="Sleep";break;case"unreachable":i+=" missing",n+=" missing",o+=" missing",a="Unreachable";break;case"turn off":i+=" missing",n+=" missing",o+=" missing",a="Turn Off";break;case"with alerts":i+=" warning",n+=" warning",o+=" warning",a="With Alerts";break;case"busy with activities":i+=" connected",n+=" connected",o+=" connected",a="Busy With Activities";break;case"with system errors":i+=" error",n+=" error",o+=" error",a="With System Errors";break;case"not initialized":i+=" missing",n+=" missing",o+=" missing",a="Not Initialized";break;default:i+=" missing",n+=" missing",o+=" missing",a="Unknown"}else i+=" missing",n+=" missing",o+=" missing",a="Unknown";i+='" title="'+a+'">',n+='">',o+='" title="'+a+'">',i+='<div class="info">',o+='<div class="info">',e[d].basicInfo.ip?(i+="<p>"+e[d].basicInfo.ip.replace(/\s/g,"&nbsp;")+"</p>",n+="<td>"+e[d].basicInfo.ip+"</td>",o+="<p>"+e[d].basicInfo.ip.replace(/\s/g,"&nbsp;")+"</p>"):(i+="<p>&mdash;</p>",n+="<td>&mdash;</td>"),e[d].basicInfo.modelname?(i+="<p>"+e[d].basicInfo.modelname.replace(/\s/g,"&nbsp;")+"</p>",n+="<td>"+e[d].basicInfo.modelname+"</td>",o+="<p>"+e[d].basicInfo.modelname.replace(/\s/g,"&nbsp;")+"</p>"):(i+="<p>&mdash;</p>",n+="<td>&mdash;</td>"),e[d].detailedInfo.firmwareVersion?(i+="<p>"+e[d].detailedInfo.firmwareVersion.replace(/\s/g,"&nbsp;")+"</p>",n+="<td>"+e[d].detailedInfo.firmwareVersion+"</td>"):(i+="<p>&mdash;</p>",n+="<td>&mdash;</td>"),n+='<td class="state">'+a+"</td>",n+=e[d].metadata.alias?"<td>"+e[d].metadata.alias+"</td>":"<td>&mdash;</td>",n+=e[d].metadata.reservedBy?"<td>"+e[d].metadata.reservedBy+"</td>":"<td>&mdash;</td>",i+="</div>",o+="</div>",i+='<div class="state">',o+='<div class="state">',null!=e[d].metadata.reservedBy&&null!=e[d].metadata.reservedUntil&&(i+="<p>RESERVED</p>",o+="<p>R</p>"),i+="</div></div>",n+="</tr>",o+="</div></div>",r[t]=e[d]}i+="</div>",n+="</tbody>",o+="</div>",$("#iconsViewPopulation").remove(),$("#listViewPopulation").remove(),$("#columnsViewPopulation").remove(),$(i).appendTo("#iconsView"),$(n).appendTo("#listView table.wrapper"),$(o).appendTo("#columnsViewPrintersColumn")}function t(){$("#iconsViewPopulation div.printer, #listViewPopulation tr.printer").off().on("click touchstart",function(e){e.preventDefault();var t=a('<div id="infoMenuDetails" class="wrapper right">',r[e.currentTarget.id]),n=i('<div id="infoMenuInformation" class="wrapper right">',r[e.currentTarget.id]);$("#infoMenuDetails").remove(),$("#infoMenuInformation").remove(),$(t).appendTo("#infoMenuDetailsWrapper"),$(n).appendTo("#infoMenuInformationWrapper"),$("#infoMenu button.actionButton").attr("name",e.currentTarget.id),$("#infoMenu").is(":hidden")&&$("#menus, #infoMenu").fadeIn("slow")}),$("#columnsViewPopulation div.printer").off().on("click touchstart",function(e){e.preventDefault();var t=a('<div id="columnsViewPrinterDetails" class="wrapper right">',r[e.currentTarget.id]),n=i('<div id="columnsViewPrinterInformation" class="wrapper right">',r[e.currentTarget.id]);$("#columnsViewPrinterDetails").remove(),$("#columnsViewPrinterInformation").remove(),$(t).appendTo("#columnsViewPrinterDetailsWrapper"),$(n).appendTo("#columnsViewPrinterInformationWrapper"),$("#columnsViewPrinterDataColumn button.actionButton").attr("name",e.currentTarget.id),$("#columnsViewPrinterDataColumn *").fadeIn("slow")})}function a(e,t){if(e+=t.basicInfo.hostname?"<p>"+t.basicInfo.hostname.replace(/\s/g,"&nbsp;")+"</p>":"<p>&mdash;</p>",e+=t.basicInfo.ip?"<p>"+t.basicInfo.ip.replace(/\s/g,"&nbsp;")+"</p>":"<p>&mdash;</p>",e+=t.basicInfo.modelname?"<p>"+t.basicInfo.modelname.replace(/\s/g,"&nbsp;")+"</p>":"<p>&mdash;</p>",e+=t.detailedInfo.firmwareVersion?"<p>"+t.detailedInfo.firmwareVersion.replace(/\s/g,"&nbsp;")+"</p>":"<p>&mdash;</p>",t.detailedInfo.status){switch(e+='<p class="state',t.detailedInfo.status.toLowerCase()){case"awake":e+=" connected";break;case"sleep":e+=" missing";break;case"unreachable":e+=" missing";break;case"turn off":e+=" missing";break;case"with alerts":e+=" warning";break;case"busy with activities":e+=" connected";break;case"with system errors":e+=" error";break;case"not initialized":e+=" missing";break;default:e+=" missing"}e+='">'+t.detailedInfo.status.replace(/\s/g,"&nbsp;")+"</p>"}else e+='<p class="state missing">Unknown</p>';return e+=t.creationDate?"<p>"+new Date(t.creationDate).toLocaleString().replace(/\s/g,"&nbsp;")+"</p>":"<p>&mdash;</p>",e+=t.lastUpdate.status?"<p>"+new Date(t.lastUpdate.status).toLocaleString().replace(/\s/g,"&nbsp;")+"</p>":"<p>&mdash;</p>",e+="</div>"}function i(e,t){return e+=t.metadata.alias?"<p>"+t.metadata.alias.replace(/\s/g,"&nbsp;")+"</p>":"<p>&mdash;</p>",e+=t.metadata.location?"<p>"+t.metadata.location.replace(/\s/g,"&nbsp;")+"</p>":"<p>&mdash;</p>",e+=t.metadata.workteam?"<p>"+t.metadata.workteam.replace(/\s/g,"&nbsp;")+"</p>":"<p>&mdash;</p>",e+=t.metadata.reservedBy?"<p>"+t.metadata.reservedBy.replace(/\s/g,"&nbsp;")+"</p>":"<p>&mdash;</p>",e+=t.metadata.reservedUntil?"<p>"+new Date(t.metadata.reservedUntil).toLocaleString().replace(/\s/g,"&nbsp;")+"</p>":"<p>&mdash;</p>",e+="</div>"}function n(e){e.metadata.alias?$('#editForm input[name="alias"]').attr("value",e.metadata.alias):$('#editForm input[name="alias"]').attr("value",""),e.metadata.location?$('#editForm input[name="location"]').attr("value",e.metadata.location):$('#editForm input[name="location"]').attr("value",""),e.metadata.workteam?$('#editForm input[name="workteam"]').attr("value",e.metadata.workteam):$('#editForm input[name="workteam"]').attr("value",""),e.metadata.reservedBy?$('#editForm input[name="reservedBy"]').attr("value",e.metadata.reservedBy):$('#editForm input[name="reservedBy"]').attr("value",""),e.metadata.reservedUntil?$('#editForm input[name="reservedUntil"]').attr("value",new Date(e.metadata.reservedUntil).toLocaleString()):$('#editForm input[name="reservedUntil"]').attr("value","")}function s(){var e,t,a="";for(e=0;e<32;e++)t=16*Math.random()|0,8!=e&&12!=e&&16!=e&&20!=e||(a+="-"),a+=(12==e?4:16==e?3&t|8:t).toString(16);return a}var r={};$.ajax({url:"http://"+serverAddress+":"+serverPort+"/printers/list",method:"GET",success:function(a,i){e(a),t()},error:function(e,t,a){a?showMessage(e.responseText,"red"):showMessage("Unable to connect to server","red")}}),$("#infoMenu button.actionButton, #columnsViewPrinterDataColumn button.actionButton").on("click touchstart",function(e){e.preventDefault();var t=a('<div id="editMenuDetails" class="wrapper right">',r[e.currentTarget.name]);$("#editMenuDetails").remove(),$(t).appendTo("#editMenuDetailsWrapper"),n(r[e.currentTarget.name]),$("#editMenu").is(":hidden")&&($("#menus").is(":hidden")&&$("#menus").fadeIn("slow"),$("#infoMenu").is(":visible")&&$("#infoMenu").fadeOut(0),$("#editMenu").fadeIn("slow"))}),$("#editForm").on("submit",function(e){e.preventDefault();var t={};t.alias=$('#editForm input[name="alias"]').val(),t.location=$('#editForm input[name="location"]').val(),t.workteam=$('#editForm input[name="workteam"]').val(),t.reservedBy=$('#editForm input[name="reservedBy"]').val(),t.reservedUntil=$('#editForm input[name="reservedUntil"]').val(),console.log(t)})});