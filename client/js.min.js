"use strict";function showMessage(e,t){$("#fixedLog p").text(e).css({color:"#FFF",background:t}),$("#fixedLog").fadeIn("slow",function(){setTimeout(function(){$("#fixedLog").fadeOut("slow")},2e3)})}var serverAddress="localhost",serverPort=8080;$(function(){$("#iconsViewTrigger").on("click touchstart",function(e){e.preventDefault(),$("#iconsView").is(":hidden")&&($("#iconsView").fadeIn(0),$("#listView, #columnsView").fadeOut(0),$("#iconsViewTrigger").addClass("current"),$("#listViewTrigger, #columnsViewTrigger").removeClass("current"))}),$("#listViewTrigger").on("click touchstart",function(e){e.preventDefault(),$("#listView").is(":hidden")&&($("#listView").fadeIn(0),$("#iconsView, #columnsView").fadeOut(0),$("#listViewTrigger").addClass("current"),$("#iconsViewTrigger, #columnsViewTrigger").removeClass("current"))}),$("#columnsViewTrigger").on("click touchstart",function(e){e.preventDefault(),$("#columnsView").is(":hidden")&&($("#columnsView").fadeIn(0),$("#iconsView, #listView").fadeOut(0),$("#columnsViewTrigger").addClass("current"),$("#iconsViewTrigger, #listViewTrigger").removeClass("current"))}),$("#advancedFiltersMenuTrigger").on("click touchstart",function(e){e.preventDefault(),$("#advancedFiltersMenu").is(":hidden")&&$("#menus, #advancedFiltersMenu").fadeIn("slow")}),$("#configMenuTrigger").on("click touchstart",function(e){e.preventDefault(),$("#configMenu").is(":hidden")&&$("#menus, #configMenu").fadeIn("slow")}),$("#menusLeftover, #menusWrapper").on("click touchstart",function(e){e.preventDefault(),!$("#infoMenu").is(":visible")||$(e.target).is("#infoMenu, #infoMenu *")&&!$(e.target).is(".closeButton")||$("#menus, #infoMenu").fadeOut("slow"),!$("#editMenu").is(":visible")||$(e.target).is("#editMenu, #editMenu *, #infoMenu button.actionButton")&&!$(e.target).is(".closeButton")||$("#menus, #editMenu").fadeOut("slow"),!$("#advancedFiltersMenu").is(":visible")||$(e.target).is("#advancedFiltersMenu, #advancedFiltersMenu *")&&!$(e.target).is(".closeButton")||$("#menus, #advancedFiltersMenu").fadeOut("slow"),!$("#configMenu").is(":visible")||$(e.target).is("#configMenu, #configMenu *")&&!$(e.target).is(".closeButton")||$("#menus, #configMenu").fadeOut("slow")})}),$(function(){function e(e){for(var t,a,n='<div id="iconsViewPopulation" class="wrapper">',i='<tbody id="listViewPopulation">',o='<div id="columnsViewPopulation" class="wrapper">',l=0;l<e.length;l++){if(t=s(),n+='<div id="'+t+'" class="printer',i+='<tr id="'+t+'" class="printer',o+='<div id="'+t+'" class="printer',e[l].detailedInfo.status)switch(e[l].detailedInfo.status.toLowerCase()){case"awake":n+=" connected",i+=" connected",o+=" connected",a="Awake";break;case"sleep":n+=" missing",i+=" missing",o+=" missing",a="Sleep";break;case"unreachable":n+=" missing",i+=" missing",o+=" missing",a="Unreachable";break;case"turn off":n+=" missing",i+=" missing",o+=" missing",a="Turn Off";break;case"with alerts":n+=" warning",i+=" warning",o+=" warning",a="With Alerts";break;case"busy with activities":n+=" connected",i+=" connected",o+=" connected",a="Busy With Activities";break;case"with system errors":n+=" error",i+=" error",o+=" error",a="With System Errors";break;case"not initialized":n+=" missing",i+=" missing",o+=" missing",a="Not Initialized";break;default:n+=" missing",i+=" missing",o+=" missing",a="Unknown"}else n+=" missing",i+=" missing",o+=" missing",a="Unknown";n+='" title="'+a+'">',i+='">',o+='" title="'+a+'">',n+='<div class="info">',o+='<div class="info">',e[l].basicInfo.ip?(n+="<p>"+e[l].basicInfo.ip.replace(/\s/g,"&nbsp;")+"</p>",i+="<td>"+e[l].basicInfo.ip+"</td>",o+="<p>"+e[l].basicInfo.ip.replace(/\s/g,"&nbsp;")+"</p>"):(n+="<p>&mdash;</p>",i+="<td>&mdash;</td>"),e[l].basicInfo.modelname?(n+="<p>"+e[l].basicInfo.modelname.replace(/\s/g,"&nbsp;")+"</p>",i+="<td>"+e[l].basicInfo.modelname+"</td>",o+="<p>"+e[l].basicInfo.modelname.replace(/\s/g,"&nbsp;")+"</p>"):(n+="<p>&mdash;</p>",i+="<td>&mdash;</td>"),e[l].detailedInfo.firmwareVersion?(n+="<p>"+e[l].detailedInfo.firmwareVersion.replace(/\s/g,"&nbsp;")+"</p>",i+="<td>"+e[l].detailedInfo.firmwareVersion+"</td>"):(n+="<p>&mdash;</p>",i+="<td>&mdash;</td>"),i+='<td class="state">'+a+"</td>",i+=e[l].metadata.alias?"<td>"+e[l].metadata.alias+"</td>":"<td>&mdash;</td>",i+=e[l].metadata.reservedBy?"<td>"+e[l].metadata.reservedBy+"</td>":"<td>&mdash;</td>",n+="</div>",o+="</div>",n+='<div class="state">',o+='<div class="state">',null!=e[l].metadata.reservedBy&&null!=e[l].metadata.reservedUntil&&(n+="<p>RESERVED</p>",o+="<p>R</p>"),n+="</div></div>",i+="</tr>",o+="</div></div>",r[t]=e[l]}n+="</div>",i+="</tbody>",o+="</div>",$("#iconsViewPopulation").remove(),$("#listViewPopulation").remove(),$("#columnsViewPopulation").remove(),$(n).appendTo("#iconsView"),$(i).appendTo("#listView table.wrapper"),$(o).appendTo("#columnsViewPrintersColumn")}function t(){$("#iconsViewPopulation div.printer, #listViewPopulation tr.printer").off().on("click touchstart",function(e){e.preventDefault();var t=a('<div id="infoMenuDetails" class="wrapper right">',r[e.currentTarget.id]),i=n('<div id="infoMenuInformation" class="wrapper right">',r[e.currentTarget.id]);$("#infoMenuDetails").remove(),$("#infoMenuInformation").remove(),$(t).appendTo("#infoMenuDetailsWrapper"),$(i).appendTo("#infoMenuInformationWrapper"),$("#infoMenu button.actionButton").attr("name",e.currentTarget.id),$("#infoMenu").is(":hidden")&&$("#menus, #infoMenu").fadeIn("slow")}),$("#columnsViewPopulation div.printer").off().on("click touchstart",function(e){e.preventDefault();var t=a('<div id="columnsViewPrinterDetails" class="wrapper right">',r[e.currentTarget.id]),i=n('<div id="columnsViewPrinterInformation" class="wrapper right">',r[e.currentTarget.id]);$("#columnsViewPrinterDetails").remove(),$("#columnsViewPrinterInformation").remove(),$(t).appendTo("#columnsViewPrinterDetailsWrapper"),$(i).appendTo("#columnsViewPrinterInformationWrapper"),$("#columnsViewPrinterDataColumn button.actionButton").attr("name",e.currentTarget.id),$("#columnsViewPrinterDataColumn *").fadeIn("slow")})}function a(e,t){if(e+=t.basicInfo.hostname?"<p>"+t.basicInfo.hostname.replace(/\s/g,"&nbsp;")+"</p>":"<p>&mdash;</p>",e+=t.basicInfo.ip?"<p>"+t.basicInfo.ip.replace(/\s/g,"&nbsp;")+"</p>":"<p>&mdash;</p>",e+=t.basicInfo.modelname?"<p>"+t.basicInfo.modelname.replace(/\s/g,"&nbsp;")+"</p>":"<p>&mdash;</p>",e+=t.detailedInfo.firmwareVersion?"<p>"+t.detailedInfo.firmwareVersion.replace(/\s/g,"&nbsp;")+"</p>":"<p>&mdash;</p>",t.detailedInfo.status){switch(e+='<p class="state',t.detailedInfo.status.toLowerCase()){case"awake":e+=" connected";break;case"sleep":e+=" missing";break;case"unreachable":e+=" missing";break;case"turn off":e+=" missing";break;case"with alerts":e+=" warning";break;case"busy with activities":e+=" connected";break;case"with system errors":e+=" error";break;case"not initialized":e+=" missing";break;default:e+=" missing"}e+='">'+t.detailedInfo.status.replace(/\s/g,"&nbsp;")+"</p>"}else e+='<p class="state missing">Unknown</p>';return e+=t.creationDate?"<p>"+new Date(t.creationDate).toLocaleString().replace(/\s/g,"&nbsp;")+"</p>":"<p>&mdash;</p>",e+=t.lastUpdate.status?"<p>"+new Date(t.lastUpdate.status).toLocaleString().replace(/\s/g,"&nbsp;")+"</p>":"<p>&mdash;</p>",e+="</div>"}function n(e,t){return e+=t.metadata.alias?"<p>"+t.metadata.alias.replace(/\s/g,"&nbsp;")+"</p>":"<p>&mdash;</p>",e+=t.metadata.location?"<p>"+t.metadata.location.replace(/\s/g,"&nbsp;")+"</p>":"<p>&mdash;</p>",e+=t.metadata.workteam?"<p>"+t.metadata.workteam.replace(/\s/g,"&nbsp;")+"</p>":"<p>&mdash;</p>",e+=t.metadata.reservedBy?"<p>"+t.metadata.reservedBy.replace(/\s/g,"&nbsp;")+"</p>":"<p>&mdash;</p>",e+=t.metadata.reservedUntil?"<p>"+new Date(t.metadata.reservedUntil).toLocaleString().replace(/\s/g,"&nbsp;")+"</p>":"<p>&mdash;</p>",e+="</div>"}function i(e,t){return e+=t.metadata.alias?'<input name="alias" type="text" value="'+t.metadata.alias.replace(/\s/g,"&nbsp;")+'" maxlength="100" placeholder="alias">':'<input name="alias" type="text" value="" maxlength="100" placeholder="alias">',e+=t.metadata.location?'<input name="location" type="text" value="'+t.metadata.location.replace(/\s/g,"&nbsp;")+'" maxlength="100" placeholder="location">':'<input name="location" type="text" value="" maxlength="100" placeholder="location">',e+=t.metadata.workteam?'<input name="workteam" type="text" value="'+t.metadata.workteam.replace(/\s/g,"&nbsp;")+'" maxlength="100" placeholder="workteam">':'<input name="workteam" type="text" value="" maxlength="100" placeholder="workteam">',e+=t.metadata.reservedBy?'<input name="reservedBy" type="text" value="'+t.metadata.reservedBy.replace(/\s/g,"&nbsp;")+'" maxlength="100" placeholder="reservedBy">':'<input name="reservedBy" type="text" value="" maxlength="100" placeholder="reserved&nbsp;by">',e+=t.metadata.reservedUntil?'<input name="reservedUntil" type="text" value="'+new Date(t.metadata.reservedUntil).toLocaleString().replace(/\s/g,"&nbsp;")+'" maxlength="100" placeholder="dd/mm/aaaa&nbsp;hh:mm">':'<input name="reservedUntil" type="text" value="" maxlength="100" placeholder="dd/mm/aaaa&nbsp;hh:mm">',e+="</form>"}function s(){var e,t,a="";for(e=0;e<32;e++)t=16*Math.random()|0,8!=e&&12!=e&&16!=e&&20!=e||(a+="-"),a+=(12==e?4:16==e?3&t|8:t).toString(16);return a}var r={};$.ajax({url:"http://"+serverAddress+":"+serverPort+"/printers/list",method:"GET",success:function(a,n){e(a),t()},error:function(e,t,a){a?showMessage(e.responseText,"red"):showMessage("Unable to connect to server","red")}}),$("#infoMenu button.actionButton, #columnsViewPrinterDataColumn button.actionButton").on("click touchstart",function(e){e.preventDefault(e);var t=a('<div id="editMenuDetails" class="wrapper right">',r[e.currentTarget.name]),n=i('<form id="editForm" class="wrapper right">',r[e.currentTarget.name]);$("#editMenuDetails").remove(),$("#editForm").remove(),$(t).appendTo("#editMenuDetailsWrapper"),$(n).appendTo("#editMenuInformationWrapper"),$("#editMenu").is(":hidden")&&($("#menus").is(":hidden")&&$("#menus").fadeIn("slow"),$("#infoMenu").is(":visible")&&$("#infoMenu").fadeOut(0),$("#editMenu").fadeIn("slow"))}),$("#editMenu button.actionButton").on("click touchstart",function(e){e.preventDefault(e);for(var t=$("#editForm").children(),a={},n=0;n<t.length;n++)switch(t[n].attributes.name.value){case"alias":a.alias=t[n].attributes.value.value;break;case"location":a.location=t[n].attributes.value.value;break;case"workteam":a.workteam=t[n].attributes.value.value;break;case"reservedBy":a.reservedBy=t[n].attributes.value.value;break;case"reservedUntil":a.reservedUntil=new Date(t[n].attributes.value.value).getTime()}console.log(a)})});